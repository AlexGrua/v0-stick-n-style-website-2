# üìã –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ú–ò–ì–†–ê–¶–ò–Ø–ú

## üö® –í–ê–ñ–ù–û: –ü–æ—Å–ª–µ DDL –æ–ø–µ—Ä–∞—Ü–∏–π

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö DDL –æ–ø–µ—Ä–∞—Ü–∏–π (CREATE, ALTER, DROP) **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PostgREST –∫–µ—à–∞
```sql
-- –í –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
NOTIFY pgrst, 'reload schema';
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ API –≤ Supabase
1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Console** ‚Üí Project Settings
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª API**
3. **–ù–∞–∂–º–∏—Ç–µ "Restart"** (–∂–µ—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å –∫–µ—à–∞)

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
npm run dev
```

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –í SQL Editor:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
SELECT to_regclass('public.subcategories');

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–æ–Ω–æ–∫
SELECT column_name FROM information_schema.columns
WHERE table_schema='public' AND table_name='products'
  AND column_name IN ('sku','subcategory_id','specifications');
```

### –í REST API:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PostgREST
curl "https://your-project.supabase.co/rest/v1/subcategories?select=id,category_id,slug&limit=1" \
  -H "apikey: your-anon-key" \
  -H "Authorization: Bearer your-anon-key"
```

### –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoints
node scripts/verify-after-fix.js
```

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Exposed Schemas
**–ü—Ä–æ–±–ª–µ–º–∞:** 500 –æ—à–∏–±–∫–∏ –Ω–∞ `/rest/v1/*`
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Settings ‚Üí API ‚Üí Exposed schemas - —Ç–∞–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å `public`

### 2. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** 401/500 –æ—à–∏–±–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ä–æ–ª–∏ `anon` –∏ `service_role` –∏–º–µ—é—Ç GRANT –Ω–∞ –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### 3. RLS –ø–æ–ª–∏—Ç–∏–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** 401 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º RLS
**–†–µ—à–µ–Ω–∏–µ:** –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ RLS –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏

### 4. –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–µ—à
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ UI
**–†–µ—à–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à SWR/React Query, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä

## üìã –ß–µ–∫–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

- [ ] DDL –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] `NOTIFY pgrst, 'reload schema'` –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–∏–≥—Ä–∞—Ü–∏—é
- [ ] API –≤ Supabase –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –°–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] Exposed schemas –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
- [ ] –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–µ—à –æ—á–∏—â–µ–Ω
- [ ] API endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞

## üîÑ CI/CD –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

### Smoke —Ç–µ—Å—Ç:
```bash
# 1. –ü–æ–¥–Ω—è—Ç—å —á–∏—Å—Ç—ã–π PG
# 2. –ü—Ä–æ–≥–Ω–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
# 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å NOTIFY
# 4. –û–¥–∏–Ω GET –Ω–∞ /rest/v1/subcategories
# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å 200
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î
node scripts/check-migration-result.js

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
node scripts/test-api-endpoints.js

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
node scripts/verify-after-fix.js
```

---

**–ó–∞–ø–æ–º–Ω–∏—Ç–µ:** DDL ‚Üí NOTIFY ‚Üí Restart API ‚Üí Restart Dev Server = ‚úÖ
