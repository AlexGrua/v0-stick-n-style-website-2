# üóÑÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –û–±–∑–æ—Ä

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã** - —ç—Ç–æ –ë–î –∏ –µ—ë –º–∏–≥—Ä–∞—Ü–∏–∏.

## üöÄ –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã** - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
2. **–ù–∏–∫–∞–∫–∏—Ö DDL –º–∏–º–æ –º–∏–≥—Ä–∞—Ü–∏–π** 
3. **–ö–∞–∂–¥–∞—è –º–∏–≥—Ä–∞—Ü–∏—è** - –∞—Ç–æ–º–∞—Ä–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
4. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ –Ω–æ–º–µ—Ä—É —Ñ–∞–π–ª–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
001_hotfix_add_missing_columns.sql  # –•–æ—Ç—Ñ–∏–∫—Å –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
002_create_unified_schema.sql       # –ï–¥–∏–Ω–∞—è —Å—Ö–µ–º–∞ (–±—É–¥—É—â–µ–µ)
003_add_product_variants.sql        # –í–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–±—É–¥—É—â–µ–µ)
```

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

### –í Supabase SQL Editor:
1. –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor –≤ Supabase Console
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∏–≥—Ä–∞—Ü–∏–∏
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ß–µ—Ä–µ–∑ Supabase CLI (–±—É–¥—É—â–µ–µ):
```bash
supabase db push
```

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ù–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏/—Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] API —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

## üö® –í–∞–∂–Ω–æ

- **–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ backup** –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
- **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ dev** –ø–µ—Ä–µ–¥ prod
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
- **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—Ç–∫–∞—Ç** (rollback) –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ

## üîí RLS (Row Level Security)

**–í–ù–ò–ú–ê–ù–ò–ï:** –ú–∏–≥—Ä–∞—Ü–∏—è 001 –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç RLS –¥–ª—è –∞–¥–º–∏–Ω–∫–∏.

### –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:
1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ RLS policies** –¥–ª—è production
2. **–í–∫–ª—é—á–∏—Ç–µ RLS –æ–±—Ä–∞—Ç–Ω–æ** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π

### –ü—Ä–∏–º–µ—Ä RLS policies –¥–ª—è –∞–¥–º–∏–Ω–∫–∏:
```sql
-- –í–∫–ª—é—á–∏—Ç—å RLS
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE subcategories ENABLE ROW LEVEL SECURITY;
ALTER TABLE suppliers ENABLE ROW LEVEL SECURITY;

-- –°–æ–∑–¥–∞—Ç—å policies –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
CREATE POLICY "Admins can do everything" ON products
  FOR ALL USING (auth.role() = 'admin');

CREATE POLICY "Admins can do everything" ON categories  
  FOR ALL USING (auth.role() = 'admin');
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
